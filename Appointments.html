<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="Shortcut Icon" type="image/png" href="stmikelogorig.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Expense Dashboard - Appointments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: url('clinicbg.jpg');
            background-size: cover;
            background-position: center;
        }

        .container {
            animation: fadeIn 0.5s ease-in-out;
            box-shadow: 0 4px 6px rgba(255, 0, 0, 1);
            background-color: rgba(255, 248, 248, 0.86);
            transition: transform 0.6s ease-in-out;
            transform-style: preserve-3d;
        }

        .container.flip {
            transform: rotateY(180deg);
        }

        .input-field,
        .select-field {
            transition: all 0.3s ease;
        }

        .input-field:focus,
        .select-field:focus {
            transform: scale(1.02);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }

        .btn {
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .loading-spinner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #1e3a8a, #7e22ce, #3b82f6, #a855f7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .spinner {
            border: 8px solid #ffffff33;
            border-top: 8px solid #ffffff;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .sidebar {
            transition: all 0.3s ease;
            width: 250px;
            background: linear-gradient(180deg, #4e2790ff 0%, #25407aff 100%);
            color: white;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 1000;
            overflow-y: auto;
        }

        .sidebar-hidden {
            transform: translateX(-250px);
        }

        .sidebar ul li a {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #d1d5db;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .sidebar ul li a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .sidebar ul li a:hover {
            background: rgba(55, 65, 81, 0.8);
            color: white;
            transform: translateX(5px);
        }

        .sidebar ul li a:hover::before {
            left: 100%;
        }

        .sidebar ul li a i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .content {
            transition: margin-left 0.3s ease;
            margin-left: 250px;
            width: calc(100% - 250px);
        }

        .content-full {
            margin-left: 0;
            width: 100%;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #10b981;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 1000;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        .section {
            scroll-margin-top: 80px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }

        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        @media (max-width: 640px) {
            .container {
                margin: 1rem;
                padding: 1.5rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            h2 { font-size: 1.5rem; }
            h3 { font-size: 1.25rem; }

            .input-field, .select-field { padding: 0.75rem; }
            table { font-size: 0.875rem; }
            th, td { padding: 0.5rem; }
            .spinner { width: 40px; height: 40px; border-width: 6px; }
            .sidebar { width: 200px; }
            .content { margin-left: 200px; width: calc(100% - 200px); }
        }

        @media (min-width: 641px) and (max-width: 1024px) {
            .container { max-width: 90%; padding: 2rem; }
            .form-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
    </div>

    <!-- Success Notification -->
    <div id="successNotification" class="notification">
        <span id="notificationMessage"></span>
        <button onclick="closeNotification()" class="ml-4 text-white underline">Close</button>
    </div>

    <!-- Error Notification -->
    <div id="errorNotification" class="notification bg-red-500" style="display: none;">
        <span id="errorMessage"></span>
        <button onclick="closeErrorNotification()" class="ml-4 text-white underline">Close</button>
    </div>

    <!-- Sidebar Navigation -->
    <div id="sidebar" class="sidebar">
        <div class="p-4">
            <h2 class="text-xl font-bold mb-4 flex items-center"><i class="fas fa-tachometer-alt mr-2"></i>Navigation</h2>
            <ul class="space-y-1">
                <li><a href="walkin.html" class="nav-link flip-link"><i class="fas fa-walking"></i> Walk-In</a></li>
                <li><a href="company.html" class="nav-link flip-link"><i class="fas fa-briefcase"></i> Company</a></li>
                <li><a href="Index.html" class="nav-link bg-red-600 hover:bg-red-700"><i class="fas fa-sign-out-alt"></i> Webpage</a></li>
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <div id="content" class="content min-h-screen">
        <div class="container max-w-7xl w-full rounded-2xl p-8 mx-4 sm:mx-6 md:mx-8">
            <div class="flex justify-between items-center mb-6">
                <button id="toggleSidebar" class="btn bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-bars mr-2"></i> Menu
                </button>
                <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">Welcome, Admin!</h2>
            </div>

            <!-- Appointments Section -->
            <div id="appointments" class="section mb-8">
                <h3 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-4">Manage Appointments</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-300 rounded-lg">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-800">No.</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-800">Patient Name</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-800">Procedure</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-800">Date</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-800">Created At</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-800">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="appointmentsTableBody">
                            <!-- Appointments will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Load appointments from localStorage or use default data
        let appointments = JSON.parse(localStorage.getItem('appointments')) || [
            { id: 1, appointment_number: 1, employee_username: "Dr. Smith", patient_name: "John Doe", procedure_name: "Dental Cleaning", appointment_date: "2025-10-01", created_at: "2025-09-28 10:00:00" },
            { id: 2, appointment_number: 2, employee_username: "Dr. Jones", patient_name: "Jane Roe", procedure_name: "Tooth Extraction", appointment_date: "2025-10-02", created_at: "2025-09-28 12:00:00" },
            { id: 3, appointment_number: 3, employee_username: "Dr. Brown", patient_name: "Alice Smith", procedure_name: "Checkup", appointment_date: "2025-10-03", created_at: "2025-09-29 09:00:00" }
        ];

        // Function to save appointments to localStorage
        function saveAppointments() {
            localStorage.setItem('appointments', JSON.stringify(appointments));
        }

        // Function to generate the next appointment number
        function getNextAppointmentNumber() {
            const maxNumber = appointments.reduce((max, appt) => Math.max(max, appt.appointment_number || 0), 0);
            return maxNumber + 1;
        }

        // Function to add a new appointment (for future expansion, not implemented here)
        function addAppointment(patientName, procedureName, appointmentDate) {
            const newId = appointments.length > 0 ? Math.max(...appointments.map(a => a.id)) + 1 : 1;
            const newAppointment = {
                id: newId,
                appointment_number: getNextAppointmentNumber(),
                employee_username: "Dr. Smith", // Default or dynamic assignment
                patient_name: patientName,
                procedure_name: procedureName,
                appointment_date: appointmentDate,
                created_at: new Date().toISOString().slice(0, 19).replace('T', ' ')
            };
            appointments.push(newAppointment);
            saveAppointments();
            displayAppointments();
        }

        // Function to display appointments
        function displayAppointments() {
            const tableBody = document.getElementById('appointmentsTableBody');
            tableBody.innerHTML = '';
            appointments.sort((a, b) => a.appointment_number - b.appointment_number).forEach(appt => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="py-3 px-4 border-b">${appt.appointment_number}</td>
                    <td class="py-3 px-4 border-b">${appt.patient_name}</td>
                    <td class="py-3 px-4 border-b">${appt.procedure_name}</td>
                    <td class="py-3 px-4 border-b">${appt.appointment_date}</td>
                    <td class="py-3 px-4 border-b">${appt.created_at}</td>
                    <td class="py-3 px-4 border-b">
                        <button onclick="deleteAppointment(${appt.id})" class="btn bg-red-600 text-white px-3 py-1 rounded-lg hover:bg-red-700">
                            <i class="fas fa-trash mr-1"></i> Delete
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Function to delete appointment
        function deleteAppointment(id) {
            if (confirm('Are you sure you want to delete this appointment?')) {
                const index = appointments.findIndex(appt => appt.id === id);
                if (index !== -1) {
                    appointments.splice(index, 1);
                    saveAppointments();
                    displayAppointments();
                    showNotification('Appointment deleted successfully!');
                } else {
                    showError('Failed to delete appointment.');
                }
            }
        }

        // Show success notification
        function showNotification(message) {
            const notification = document.getElementById('successNotification');
            document.getElementById('notificationMessage').textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }

        // Show error notification
        function showError(message) {
            const notification = document.getElementById('errorNotification');
            document.getElementById('errorMessage').textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }

        // Close notifications
        function closeNotification() {
            document.getElementById('successNotification').style.display = 'none';
        }

        function closeErrorNotification() {
            document.getElementById('errorNotification').style.display = 'none';
        }

        // Function to trigger flip animation
        function triggerFlipAnimation() {
            const container = document.querySelector('.container');
            container.classList.add('flip');
            setTimeout(() => {
                container.classList.remove('flip');
            }, 600); // Match the transition duration
        }

        // Hide loading spinner and initialize table
        window.addEventListener('load', function() {
            document.getElementById('loadingSpinner').style.display = 'none';
            displayAppointments();
        });

        // Toggle sidebar
        document.getElementById('toggleSidebar').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            const content = document.getElementById('content');
            sidebar.classList.toggle('sidebar-hidden');
            content.classList.toggle('content-full');
        });

        // Flip animation for Walk-In and Company navigation links
        document.querySelectorAll('.flip-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                triggerFlipAnimation();
                const href = this.getAttribute('href');
                setTimeout(() => {
                    window.location.href = href;
                }, 600); // Match the transition duration
            });
        });

        // Animate sections on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            observer.observe(section);
        });
    </script>
</body>
</html>